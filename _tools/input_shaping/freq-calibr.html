---
title:        'Input Shaping Calibration Pattern'
description:  'Create G-code to calibrate IS setting'
category:     [ tools ]
---
<script language="JavaScript" type="text/javascript" src="{{ site.js }}jquery-2.2.1.min.js"></script>
<script language="JavaScript" type="text/javascript" src="{{ site.js }}jquery-ui.min.js"></script>
<script language="JavaScript" type="text/javascript" src="{{ site.js }}FileSaver.min.js"></script>
<script language="JavaScript" type="text/javascript" src="./freq-calibr.js"></script>
<div class="container" role="main">
  <div class="row">
    <div id="calibpat">
      <h1>Input Shaping Calibration Pattern</h1>
      <div class="row alert alert-info custom-alert">
        <div class="col-lg-1 col-md-2 visible-md-block custom-alert-icon"> <i class="fa fa-info-circle fa-4x" aria-hidden="true"></i> </div>
        <div class="col-lg-11 col-md-10 custom-alert-text">
          <p><em>Caution!</em><br/>
          Works for cartesian printers with rectangular bed. Core-XY is not tested.</p>
        </div>
      </div>
      <p>Use this form to generate G-code that you can use to calibrate your Input Shaping Damping Frequency and Zeta/Damping factor. Default values apply to standard PLA with a 0.4mm nozzle.</p>
      <p>G-code sweeps zig zag patterns with increasing speeds, or increasing frequencies.</p>
      <p>Generates 3 separate files:</p>
      <ul>Damping Frequency to find resonant frequency for X and Y, shown on right side</ul>
      <ul>Zeta/damping factor for X, not shown</ul>
      <ul>Zeta/damping factor for Y, not shown</ul>
      <p>Press the <strong>Generate G-code</strong> button followed by each <strong>Download .. as file</strong> to save the results.</p>
      <table id="kfactor">
        <tbody>
          <tr class="head">
            <td colspan="3"><h3>Settings</h3></td>
            <td><h3>G-code</h3></td>
          </tr>
          <tr>
            <td colspan="3" class="section"><h4>Printer Info</h4></td>
            <td rowspan="21">
              <textarea name="freq-gcode-out" id="freq-gcode-out" style="height:100%"></textarea>
            </td>
            <td class="td-hidden">
              <textarea name="zeta-x-gcode-out" id="zeta-x-gcode-out" style="height:100%"></textarea>
            </td>
            <td class="td-hidden">
              <textarea name="zeta-y-gcode-out" id="zeta-y-gcode-out" style="height:100%"></textarea>
            </td>
            
          </tr>
          <tr>
            <th><label for="PRINTER">Printer Name</label></th>
            <td><input name="PRINTER" id="PRINTER" value="printer name" /></td>
          </tr>
          <tr>
            <th><label for="FILAMENT_DIAMETER">Filament Diameter</label></th>
            <td><input name="FILAMENT_DIAMETER" id="FILAMENT_DIAMETER" step="any" value="1.75" onblur="validateInput()" /></td>
            <td>Diameter of the used filament (mm)</td>
          </tr>
          <tr>
            <th><label for="NOZZLE_DIAMETER">Nozzle Diameter</label></th>
            <td><input name="NOZZLE_DIAMETER" id="NOZZLE_DIAMETER" step="any" value="0.4" onblur="validateInput()" /></td>
            <td>Diameter of the nozzle (mm)</td>
          </tr>
          <tr>
            <th><label for="NOZZLE_TEMP">Nozzle Temperature</label></th>
            <td><input name="NOZZLE_TEMP" id="NOZZLE_TEMP" step="any" value="205" onblur="validateInput()" /></td>
            <td>Nozzle Temperature (°C)</td>
          </tr>
          <tr>
            <th><label for="BED_TEMP">Bed Temperature</label></th>
            <td><input name="BED_TEMP" id="BED_TEMP" step="any" value="60" onblur="validateInput()" /></td>
            <td>Bed Temperature (°C)</td>
          </tr>
          <tr>
            <th><label for="LAYER_HEIGHT">Layer Height</label></th>
            <td><input name="LAYER_HEIGHT" id="LAYER_HEIGHT" step="0.1" value="0.2" onblur="validateInput()" /></td>
            <td>Layer Height (mm)</td>
          </tr>
          <tr>
            <th><label for="FAN_SPEED">Fan Speed</label></th>
            <td><input name="FAN_SPEED" id="FAN_SPEED" step="1" value="0" onblur="validateInput()" /></td>
            <td>Fan Speed (%)</td>
          </tr>
          <tr>
            <td colspan="3" class="section"><h4>Speed</h4></td>
          </tr>
          <tr>
            <th><label for="PRINT_SPEED">Printing Speed</label></th>
            <td><input name="PRINT_SPEED" id="PRINT_SPEED" step="any" value="40" onblur="validateInput()" /></td>
            <td>Printing speed for 1st Layer </td>
          </tr>
          <tr>
            <th><label for="TRAVEL_SPEED">Travel Speed</label></th>
            <td><input name="TRAVEL_SPEED" id="TRAVEL_SPEED" step="any" value="100" onblur="validateInput()" /></td>
            <td>Travel speed for 1st Layer </td>
          </tr>
          <tr>
            <td colspan="3" class="section"><h4>Print Bed</h4></td>
          </tr>
          <tr>
            <th><label for="BEDSIZE_X">Bed Size X</label></th>
            <td><input name="BEDSIZE_X" id="BEDSIZE_X" step="any" value="200" onblur="validateInput()" /></td>
            <td id="shape">Size (mm) of the bed in X</td>
          </tr>
          <tr>
            <th><label for="BEDSIZE_Y">Bed Size Y</label></th>
            <td><input name="BEDSIZE_Y" id="BEDSIZE_Y" step="any" value="200" onblur="validateInput()" /></td>
            <td>Size (mm) of the bed in Y</td>
          </tr>
          <tr>
            <td colspan="3" class="section"><h4>Pattern</h4></td>
          </tr>
          <tr>
            <th><label for="MAX_FREQ_X">Max X Frequency</label></th>
            <td><input name="MAX_FREQ_X" id="MAX_FREQ_X" step="any" value="60" onblur="validateInput()" /></td>
            <td id="x_factor">Maximum frequency for X pattern</td>
          </tr>
          <tr>
            <th><label for="MAX_FREQ_Y">Max Y Frequency</label></th>
            <td><input name="MAX_FREQ_Y" id="MAX_FREQ_Y" step="any" value="60" onblur="validateInput()" /></td>
            <td id="y_factor">Maximum frequency for Y pattern</td>
          </tr>
          <tr>
            <th><label for="Z_OFFSET">Z-Offset</label></th>
            <td><input name="Z_OFFSET" id="Z_OFFSET" step="any" value="0" onblur="validateInput()" /></td>
            <td>Offset the Z-axis for manual Layer adjustment</td>
          </tr>
          <tr>
            <th><label for="BED_LEVELING">Use Bed Leveling</label></th>
            <td><select name="BED_LEVELING" id="BED_LEVELING" onchange="validateInput()">
              <option value="0" selected="selected">No</option>
              <option value="G29 ; Level bed">Level bed (G29)</option>
              <option value="M420 S1 ; Leveling ON">Leveling ON</option>
              <option value="M420 L0 S1 ; Load UBL mesh 0">Load UBL mesh 0</option>
              <option value="M420 L1 S1 ; Load UBL mesh 1">Load UBL mesh 1</option>
              <option value="M420 L2 S1 ; Load UBL mesh 2">Load UBL mesh 2</option>
              <option value="M420 L3 S1 ; Load UBL mesh 3">Load UBL mesh 3</option>
            </select></td>
            <td>Level bed or load a saved mesh (i.e. for UBL) before printing. Bed leveling has to be activated in Configuration.h! Loading a mesh requires UBL to be activated!</td>
          </tr>
          <tr>
            <th><label for="EXTRUSION_MULT">Extrusion Multiplier</label></th>
            <td><input name="EXTRUSION_MULT" id="EXTRUSION_MULT" step="0.1" value="1.0" onblur="validateInput()" /></td>
            <td>Usually 1.0</td>
          </tr>
          <tr>
            <th><label for="Z_ALIGNMENT">Align Z</label></th>
            <td><input name="Z_ALIGNMENT" type="checkbox" id="Z_ALIGNMENT" /></td>
            <td>Align the Z gantry by running the G34 command</td>
          </tr>
          <tr class="calibpat2">
            <th><label for="FILENAME">Filename</label></th>
            <td colspan="2"><input name="FILENAME" id="FILENAME" value="filename" />
              <input name="button" type="button" id="button" onclick="genGcode()" value="Generate G-code" />
              <input name="button3" type="button" id="button3" onclick="setLocalStorage()" value="Save as default" title="Save settings in a cookie." />
            <p id="warning1" style="display: none;">warning</p>
            <p id="warning2" style="display: none;">warning</p>
            <p id="warning3" style="display: none;">warning</p></td>
            <td class="options"><p>
              <input name="button2" type="button" id="button2" onclick="saveTextAsFile(0)" value="Download Damping Frequency as file" />
              <input name="button4" type="button" id="button4" onclick="saveTextAsFile(1)" value="Download Damping/zeta factor for X as file" />
              <input name="button5" type="button" id="button5" onclick="saveTextAsFile(2)" value="Download Damping/zeta factor for Y as file" />
            </p></td>
          </tr>
        </tbody>
      </table>
      <h3>Notes on the settings:</h3>
      <ul>
        <li><strong>Max X Frequency</strong> and <strong>Max Y Frequency</strong> should be high enough to reach resonant frequency. 60 should be enough, but can be increased if resonance is not seen</li>
        <li><strong>Use Bed Leveling</strong> requires a probe.</li>
      </ul>
      <h2>Images</h2>
      <p>TODO: The following screen-shots show some examples of the test patterns</p>
      <ul>
        <li>Blue Lines are Slow Printing Speeds</li>
        <li>Red Lines are Fast Printing Speed</li>
        <li>Light blue lines are movements</li>
      </ul>
      <div class="row">
        <div class="col-sm-6">
          <h3>Damping Frequency Pattern</h3>
          <img src="/assets/images/features/freq-calibr/freq-pattern.jpg" alt="DampingFrequencyPattern" />
        </div>
      </div>
  </div>
</div>
